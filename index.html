<!DOCTYPE html>
<html>
<head>
    <title>SOCEA Official Member Map</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.js"></script>
    
    <script src="countries.js"></script>

    <style>
        body { margin: 0; padding: 0; font-family: 'Segoe UI', Tahoma, sans-serif; }
        #map { height: 100vh; width: 100%; background: #f0f2f5; }
        
        /* SOCEA Official Branding */
        .map-logo {
            position: absolute; top: 20px; right: 20px; z-index: 1000;
            background: white; padding: 10px; border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.15); border: 1px solid #003366;
        }
        .map-header {
            position: absolute; top: 20px; left: 60px; z-index: 1000;
            background: white; padding: 15px 25px; border-radius: 4px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.15); border-left: 6px solid #003366;
        }
        .legend { background: white; padding: 12px; line-height: 22px; border-radius: 4px; box-shadow: 0 0 10px rgba(0,0,0,0.1); font-size: 13px; }
        .legend i { width: 14px; height: 14px; float: left; margin: 4px 8px 0 0; border-radius: 2px; }
    </style>
</head>
<body>

    <div class="map-logo">
        <img src="https://via.placeholder.com/150x50?text=SOCEA+OFFICIAL" width="140" alt="SOCEA Logo">
    </div>

    <div class="map-header">
        <strong style="font-size: 22px; color: #003366;">SOCEA</strong><br>
        <span style="font-size: 11px; color: #666; font-weight: bold; text-transform: uppercase;">Regional ANSP Coordination Platform</span>
    </div>

    <div id="map"></div>

    <script>
        // 1. Initialize Map
        var map = L.map('map').setView([42, 50], 4);

        // 2. Add Base Layer (Clean Light Theme)
        L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
            attribution: 'SOCEA 2026'
        }).addTo(map);

        // 3. Define Members (Matching your file's naming exactly)
        const soceaMembers = {
            "Turkey": { status: "Founder", ansp: "DHMÄ°" },
            "Azerbaijan": { status: "Founder", ansp: "AZANS" },
            "Kazakhstan": { status: "Member", ansp: "Kazaeronavigatsia" },
            "Uzbekistan": { status: "Member", ansp: "Uzaeronavigation" },
            "Kyrgyzstan": { status: "Member", ansp: "Kyrgyzaeronavigatsia" },
            "Tajikistan": { status: "Member", ansp: "Tajikairnavigation" },
            "Hungary": { status: "Member", ansp: "HungaroControl" },
            "Bulgaria": { status: "Observer", ansp: "BULATSA" }
        };

        // 4. Draw Precise Borders
        if (typeof worldCountries !== 'undefined') {
            L.geoJSON(worldCountries, {
                style: function(feature) {
                    // This checks the 'name' property you found in your file
                    var countryName = feature.properties.name;
                    var member = soceaMembers[countryName];
                    
                    return {
                        fillColor: member ? (member.status === 'Founder' ? '#003366' : 
                                            member.status === 'Member' ? '#3399ff' : '#f39c12') : 'transparent',
                        weight: member ? 1.5 : 0.2,
                        opacity: 1,
                        color: member ? 'white' : '#d1d1d1',
                        fillOpacity: member ? 0.75 : 0
                    };
                },
                onEachFeature: function(feature, layer) {
                    var countryName = feature.properties.name;
                    var member = soceaMembers[countryName];
                    
                    if (member) {
                        layer.bindPopup("<b>" + countryName + "</b><br>ANSP: " + member.ansp + "<br>Status: " + member.status);
                        
                        layer.on('mouseover', function() { this.setStyle({ fillOpacity: 0.9 }); });
                        layer.on('mouseout', function() { this.setStyle({ fillOpacity: 0.75 }); });
                    }
                }
            }).addTo(map);
        }

        // 5. Add Legend
        var legend = L.control({position: 'bottomright'});
        legend.onAdd = function (map) {
            var div = L.DomUtil.create('div', 'legend');
            div.innerHTML = '<strong>SOCEA Status</strong><br>' +
                            '<i style="background: #003366"></i> Founding Member<br>' +
                            '<i style="background: #3399ff"></i> Full Member<br>' +
                            '<i style="background: #f39c12"></i> Observer State';
            return div;
        };
        legend.addTo(map);
    </script>
</body>
</html>

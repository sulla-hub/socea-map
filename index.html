<!DOCTYPE html>
<html>
<head>
    <title>SOCEA Map - Diagnostic Mode</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.9.4/leaflet.js"></script>
    
    <script src="countries.js"></script>

    <style>
        body { margin: 0; padding: 0; font-family: sans-serif; }
        #map { height: 100vh; width: 100%; background: #e0e0e0; }
        #status-log { 
            position: absolute; bottom: 20px; left: 20px; z-index: 2000; 
            background: rgba(0,0,0,0.8); color: #00ff00; padding: 15px; 
            font-family: monospace; font-size: 12px; border-radius: 5px;
            max-width: 400px;
        }
    </style>
</head>
<body>

    <div id="status-log">
        <b>System Status:</b><br>
        <span id="leaflet-check">Checking Leaflet...</span><br>
        <span id="data-check">Checking countries.js...</span><br>
        <span id="map-check">Initializing Map...</span>
    </div>

    <div id="map"></div>

    <script>
        // 1. Check if Leaflet loaded
        if (typeof L !== 'undefined') {
            document.getElementById('leaflet-check').innerHTML = "✅ Leaflet Engine: LOADED";
        } else {
            document.getElementById('leaflet-check').innerHTML = "❌ Leaflet Engine: FAILED (Blocked by firewall?)";
        }

        // 2. Check if countries.js loaded
        if (typeof worldCountries !== 'undefined') {
            document.getElementById('data-check').innerHTML = "✅ countries.js data: FOUND";
        } else {
            document.getElementById('data-check').innerHTML = "❌ countries.js data: NOT FOUND (Check filename/variable)";
        }

        try {
            var map = L.map('map').setView([42, 55], 4);
            
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);
            document.getElementById('map-check').innerHTML = "✅ Map initialized successfully.";

            const socea = {"TUR":"Founder", "AZE":"Founder", "KAZ":"Member", "UZB":"Member", "KGZ":"Member", "TJK":"Member", "HUN":"Member", "BGR":"Observer"};

            if (typeof worldCountries !== 'undefined') {
                L.geoJSON(worldCountries, {
                    style: function(f) {
                        var m = socea[f.id || f.properties.ISO_A3];
                        return {
                            fillColor: m === 'Founder' ? '#003366' : m === 'Member' ? '#3399ff' : m === 'Observer' ? '#f39c12' : 'transparent',
                            weight: m ? 1.5 : 0,
                            color: 'white',
                            fillOpacity: m ? 0.8 : 0
                        };
                    }
                }).addTo(map);
            }
        } catch (e) {
            document.getElementById('map-check').innerHTML = "❌ Map Error: " + e.message;
        }
    </script>
</body>
</html>
